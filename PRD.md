# XU-News-AI-RAG：个性化新闻智能知识库
## 产品需求文档（PRD）

---

## 1. 引言

### 1.1 背景
在信息爆炸的时代，用户面临着海量新闻信息难以有效获取和管理的挑战。传统的新闻获取方式存在信息分散、检索效率低、缺乏个性化推荐等问题。为了帮助用户更高效地获取、管理和检索新闻信息，需要构建一个基于AI技术的智能新闻知识库系统，通过RAG（检索增强生成）技术实现个性化新闻服务。

### 1.2 目标用户
- **新闻阅读爱好者**：需要高效获取和管理新闻信息的个人用户
- **内容管理者**：需要对新闻内容进行分类、标注、管理的运营人员
- **研究人员**：需要从新闻中提取关键信息进行研究的专业人士

### 1.3 产品愿景
构建一个集新闻采集、智能存储、语义检索、知识分析于一体的个性化新闻智能知识库系统，通过AI技术实现新闻信息的自动化采集、结构化存储、智能检索和深度分析，为用户提供高效、精准、个性化的新闻信息服务。

---

## 2. 用户故事与场景描述

### 2.1 新闻采集场景
**用户故事**：作为系统管理员，我希望系统能够自动定时采集新闻信息，以便及时获取最新的新闻内容。

**场景描述**：
- 系统通过定时任务自动从RSS源、网页抓取和智能代理工具获取新闻
- 采集到的新闻信息自动入库并发送邮件通知
- 管理员可查看采集日志和统计信息

### 2.2 知识库管理场景
**用户故事**：作为内容管理员，我希望能够方便地管理知识库内容，包括查看、筛选、编辑、删除等操作。

**场景描述**：
- 管理员登录系统后，可查看所有入库的新闻数据
- 支持按类型、时间等维度筛选数据
- 可对单条或批量数据进行删除操作
- 可编辑元数据（标签、来源等）
- 支持通过页面上传多种类型数据至知识库

### 2.3 智能检索场景
**用户故事**：作为普通用户，我希望通过自然语言提问快速找到相关的新闻信息。

**场景描述**：
- 用户登录后，在搜索框输入问题
- 系统优先从知识库中检索相关内容，按相似度排序返回
- 如果知识库未匹配到相关数据，系统自动触发联网查询
- 联网查询结果经大语言模型推理后输出前3条最相关结果

### 2.4 数据分析场景
**用户故事**：作为内容管理员，我希望了解知识库中新闻的关键词分布情况。

**场景描述**：
- 管理员登录后，可查看知识库数据聚类分析报告
- 报告展示关键词Top10分布情况
- 帮助管理员了解知识库内容的热点和趋势

---

## 3. 产品范围与功能列表（Scope & Features）

### 3.1 核心功能

#### 3.1.1 新闻采集功能
- **定时任务机制**：支持配置定时任务，自动执行新闻采集
- **多源采集**：支持RSS订阅、网页抓取、智能代理工具等多种采集方式
- **规范遵守**：严格遵守网络爬虫规范与安全准则
- **邮件通知**：信息入库成功后，自动发送邮件提示（标题及内容可自定义）

#### 3.1.2 知识库构建功能
- **数据入库**：通过API将抓取的信息写入知识库系统
- **数据类型支持**：支持结构化数据（可通过Excel整理）与非结构化数据类型
- **向量化存储**：自动将文本数据转换为向量并存储到向量数据库

#### 3.1.3 用户认证功能
- **用户登录**：提供用户登录功能，支持身份验证
- **权限管理**：基于登录状态控制功能访问权限

#### 3.1.4 知识库管理功能
- **数据列表查看**：支持查看知识库中的所有数据
- **数据筛选**：支持按类型、时间等维度筛选数据
- **数据删除**：支持单条或批量删除操作
- **元数据编辑**：支持编辑标签、来源等元数据信息
- **数据上传**：支持通过页面上传多种类型数据至知识库

#### 3.1.5 语义查询功能
- **知识库检索**：基于用户提问优先检索知识库内容
- **相似度排序**：检索结果按相似度排序返回
- **联网查询**：若知识库未匹配到相关数据，自动触发联网查询（如调用百度搜索API）
- **智能推理**：联网查询结果经大语言模型推理后输出前3条结果

#### 3.1.6 数据分析功能
- **聚类分析**：提供知识库数据聚类分析报告
- **关键词统计**：展示关键词Top10分布情况

### 3.2 功能边界
- 本版本不包含用户注册功能，用户账号需由管理员预先创建
- 不包含新闻推荐算法，仅提供检索功能
- 不包含多用户权限分级管理，所有登录用户具有相同权限
- 不包含数据导出功能

---

## 4. 产品特定AI需求

### 4.1 模型需求（功能、性能指标）

#### 4.1.1 大语言模型
- **模型选择**：基于Ollama部署qwen3::4b模型
- **功能要求**：
  - 支持文本理解与生成
  - 支持联网查询结果的推理与总结
  - 支持自然语言问答
- **性能指标**：
  - 响应时间：单次推理响应时间 < 5秒
  - 并发支持：支持至少10个并发请求
  - 准确率：问答准确率 > 80%

#### 4.1.2 嵌入模型
- **模型选择**：all-MiniLM-L6-v2
- **功能要求**：
  - 将文本转换为768维向量
  - 支持中英文文本嵌入
- **性能指标**：
  - 向量化速度：单条文本处理时间 < 100ms
  - 向量维度：768维
  - 相似度计算准确率 > 85%

#### 4.1.3 重排模型
- **模型选择**：ms-marco-MiniLM-L-6-v2
- **功能要求**：
  - 对检索结果进行相关性重排序
  - 提升检索结果的相关性
- **性能指标**：
  - 重排响应时间 < 500ms
  - 重排后Top3结果相关性提升 > 15%

### 4.2 数据需求（来源、数量、质量、标注）

#### 4.2.1 数据来源
- **RSS订阅源**：支持主流新闻网站的RSS订阅
- **网页抓取**：支持从指定新闻网站抓取内容
- **智能代理工具**：通过代理工具获取新闻信息
- **用户上传**：支持用户通过页面上传Excel、文本等格式数据

#### 4.2.2 数据数量
- **初始数据量**：建议至少采集1000条新闻数据用于测试
- **持续增长**：通过定时任务持续采集，数据量持续增长
- **存储容量**：支持至少10万条新闻数据的存储

#### 4.2.3 数据质量要求
- **数据完整性**：确保采集的数据包含标题、内容、来源、时间等基本字段
- **数据准确性**：过滤重复、错误、无效的新闻数据
- **数据时效性**：优先采集最新发布的新闻信息
- **数据格式规范**：统一数据格式，便于后续处理

#### 4.2.4 数据标注
- **元数据标注**：每条数据包含数据类型、来源、采集时间等元数据
- **标签管理**：支持管理员手动添加标签
- **分类标注**：支持按新闻类型进行分类标注

### 4.3 算法边界与可解释性

#### 4.3.1 算法边界
- **检索范围**：语义检索仅限知识库内数据，不包含外部实时数据（联网查询除外）
- **检索精度**：相似度阈值可配置，默认返回相似度 > 0.7的结果
- **推理能力**：大语言模型主要用于结果总结和推理，不进行事实性知识生成

#### 4.3.2 可解释性
- **相似度分数**：检索结果需显示相似度分数，便于用户判断相关性
- **来源标注**：所有检索结果需明确标注数据来源
- **推理过程**：联网查询结果需说明推理依据

### 4.4 评估标准

#### 4.4.1 检索效果评估
- **检索准确率**：Top3结果中至少2条与用户问题相关
- **检索召回率**：能够检索到知识库中80%以上的相关内容
- **响应时间**：检索响应时间 < 2秒

#### 4.4.2 系统性能评估
- **采集成功率**：新闻采集成功率 > 95%
- **入库成功率**：数据入库成功率 > 99%
- **系统可用性**：系统可用性 > 99%

#### 4.4.3 用户体验评估
- **查询满意度**：用户对检索结果的满意度 > 75%
- **操作便捷性**：核心功能操作步骤 < 3步

### 4.5 伦理与合规

#### 4.5.1 网络爬虫规范
- **遵守robots.txt**：严格遵守目标网站的robots.txt协议
- **访问频率控制**：
  - 单个目标网站访问频率不超过每分钟2次（建议设置为每分钟1-2次）
  - 每次请求之间设置随机延迟（30-60秒），模拟人工访问行为
  - 避免高频访问导致被网站防御机制拦截或封禁IP
  - 支持配置不同网站的访问频率限制，默认限制为每分钟最多2次请求
  - 数据流量控制：单次采集数据量不超过100条，避免大量数据请求触发反爬虫机制
- **请求头设置**：使用真实的User-Agent，模拟浏览器访问
- **版权尊重**：尊重内容版权，仅用于个人学习研究，不进行商业用途

#### 4.5.2 数据隐私保护
- **用户数据保护**：用户登录信息加密存储，不泄露用户隐私
- **数据使用规范**：采集的数据仅用于知识库检索，不进行其他用途

#### 4.5.3 内容安全
- **内容审核**：对采集的内容进行基本的安全审核
- **敏感信息过滤**：过滤敏感、违法、不良信息

---

## 5. 非功能性需求（性能、安全、可用性等）

### 5.1 性能需求
- **响应时间**：
  - 页面加载时间 < 2秒
  - API接口响应时间 < 1秒
  - 检索响应时间 < 2秒
- **并发支持**：支持至少50个并发用户
- **数据处理能力**：支持单次处理1000条数据的批量操作
- **存储性能**：向量数据库检索速度 < 100ms（10万条数据规模）

### 5.2 安全需求
- **身份认证**：采用Spring Security框架或JWT技术方案实现用户身份验证
- **数据加密**：用户密码采用加密存储，敏感数据传输采用HTTPS
- **访问控制**：未登录用户无法访问核心功能
- **SQL注入防护**：采用参数化查询防止SQL注入攻击
- **XSS防护**：对用户输入进行过滤，防止XSS攻击

### 5.3 可用性需求
- **系统稳定性**：系统连续运行时间 > 720小时（30天）
- **错误处理**：系统异常时提供友好的错误提示
- **日志记录**：记录关键操作日志，便于问题排查
- **数据备份**：定期备份数据库，支持数据恢复

### 5.4 可维护性需求
- **代码规范**：遵循统一的代码规范和注释标准
- **模块化设计**：采用模块化设计，便于维护和扩展
- **文档完整性**：提供完整的技术文档和API文档

### 5.5 可扩展性需求
- **架构设计**：采用微服务或模块化架构，便于功能扩展
- **数据库设计**：数据库设计支持水平扩展
- **API设计**：API接口设计遵循RESTful规范，便于集成

### 5.6 兼容性需求
- **浏览器兼容**：支持Chrome、Firefox、Edge等主流浏览器
- **操作系统兼容**：支持Windows、Linux、macOS等主流操作系统
- **数据库兼容**：支持MySQL 5.7+版本

---

## 6. 发布标准与衡量指标

### 6.1 发布标准

#### 6.1.1 功能完整性
- ✅ 所有核心功能开发完成并通过测试
- ✅ 用户登录功能正常
- ✅ 新闻采集功能正常
- ✅ 知识库管理功能正常
- ✅ 语义查询功能正常
- ✅ 数据分析功能正常

#### 6.1.2 代码质量
- ✅ 代码通过代码审查
- ✅ 单元测试覆盖率 > 70%
- ✅ 集成测试通过率 100%
- ✅ API测试通过率 100%
- ✅ 无严重代码缺陷

#### 6.1.3 文档完整性
- ✅ 产品需求文档（PRD）完整
- ✅ 概要设计文档完整
- ✅ 技术架构文档完整
- ✅ 产品原型设计文件完整
- ✅ 项目说明文档（README.md）完整
- ✅ SQL语句文档完整

#### 6.1.4 部署要求
- ✅ 项目代码上传至GitHub仓库（仓库名：xu-ai-news-rag）
- ✅ README.md包含项目部署、运行及使用说明
- ✅ 提供完整的部署脚本或部署文档

### 6.2 衡量指标

#### 6.2.1 功能指标
- **功能完成度**：100%（所有需求功能均已实现）
- **功能正确性**：核心功能测试通过率 100%
- **功能易用性**：用户操作流程顺畅，无明显卡顿

#### 6.2.2 性能指标
- **系统响应时间**：平均响应时间 < 2秒
- **系统并发能力**：支持50个并发用户
- **系统稳定性**：连续运行30天无重大故障

#### 6.2.3 质量指标
- **代码覆盖率**：单元测试覆盖率 > 70%
- **缺陷密度**：每千行代码缺陷数 < 5个
- **文档完整性**：所有必需文档均已提供

---

## 7. 待定项与未来规划

### 7.1 待定项
- **用户注册功能**：当前版本不包含用户注册，后续版本可考虑添加
- **多语言支持**：当前版本主要支持中文，后续可考虑支持多语言
- **移动端适配**：当前版本主要面向PC端，后续可考虑开发移动端应用
- **推荐算法**：当前版本不包含个性化推荐，后续可考虑添加推荐功能
- **数据可视化**：当前版本数据分析功能较简单，后续可考虑增强数据可视化

### 7.2 未来规划

#### 7.2.1 短期规划（3-6个月）
- 优化检索算法，提升检索准确率和召回率
- 增加更多新闻源，扩大数据采集范围
- 优化用户界面，提升用户体验
- 增加数据导出功能，支持多种格式导出

#### 7.2.2 中期规划（6-12个月）
- 开发移动端应用，支持移动设备访问
- 实现个性化推荐功能，基于用户行为推荐相关新闻
- 增加多用户权限管理，支持不同角色和权限
- 集成更多AI能力，如情感分析、事件抽取等

#### 7.2.3 长期规划（12个月以上）
- 构建新闻知识图谱，实现知识关联和推理
- 开发智能摘要功能，自动生成新闻摘要
- 支持多语言新闻采集和检索
- 构建新闻事件追踪系统，自动追踪新闻事件发展

---

## 附录

### A. 技术栈选型
- **前端框架**：React 18 + Vite
- **后端框架**：Flask 3.0
- **关系型数据库**：MySQL
- **向量数据库**：FAISS
- **文本嵌入**：sentence-transformers (all-MiniLM-L6-v2)
- **重排模型**：CrossEncoder (ms-marco-MiniLM-L-6-v2)
- **大模型部署**：Ollama (qwen2.5:4b)
- **认证方案**：JWT (PyJWT)

**说明**：
- **LangChain框架**：本项目未使用LangChain框架，而是采用sentence-transformers直接实现的方式。虽然未使用LangChain，但实现了相同的功能（文本嵌入、向量存储、向量检索、结果重排），且性能更优、代码更直观。详见《技术架构文档》。
- **数据库选型**：使用MySQL数据库，通过环境变量配置。使用SQLAlchemy ORM。

### B. 数据存储设计
- **元数据存储**：关系型数据库（MySQL），存储数据ID、数据类型、来源、时间等元数据
  - 通过环境变量配置MySQL连接
- **向量数据存储**：FAISS向量数据库，存储文本向量数据
  - 存储位置：`back/instance/faiss_index_<知识库名称>/`
  - 索引文件：`index.faiss`（向量索引）
  - 文档文件：`documents.pkl`（文本和元数据）
- **数据分类管理**：实现元数据与向量数据的分类管理与高效检索

### C. 核心业务流程
1. **新闻采集流程**：定时任务 → 多源采集 → 数据清洗 → 向量化 → 入库 → 邮件通知
2. **检索流程**：用户提问 → 向量化 → 知识库检索 → 重排序 → 结果返回（如无结果则联网查询）
3. **管理流程**：用户登录 → 权限验证 → 功能操作 → 结果反馈

---

**文档版本**：v1.0  
**创建日期**：2025年11月9日  
**最后更新**：2025年11月9日  
**文档状态**：待评审

